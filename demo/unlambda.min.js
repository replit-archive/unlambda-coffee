(function(){var c,h,f;h=0;c=function(a,b){h>=500?setTimeout(function(){return a(b)},0):(h++,a(b));return null};f=function(a){var b;b=a[0];a=a[1];switch(b){case "r":case "i":case "k":case "s":case "v":case "d":case "c":case "e":case "@":case "|":return b;case "c1":return"<cont>";case ".":case "?":return b+a;case "k1":case "s1":case "d1":return"`"+b[0]+f(a);case "`":return"`"+f(a[0])+f(a[1]);case "s2":return"``s"+f(a[0])+f(a[1]);default:throw Error("Unparse: unknown function: "+b);}};this.Unlambda=
{parse:function(a){var b;b=function(){var c;if(a.length===0)throw Error("Unexpected end of input.");if(a[0]==="`")a=a.slice(1),c=["`",[b(),b()]];else if(/^[rksivdce@|]/.test(a))c=[a[0],null],a=a.slice(1);else if(/^[.?]./.test(a))c=[a[0],a[1]],a=a.slice(2);else if(c=a.match(/^(\s+|#.*)/))a=a.slice(c[0].length),c=b();else throw Error("Invalid character at: "+a);return c};return b()},unparse:f,eval:function(a,b,f,h,m){var j,g,i;i=void 0;j=function(a,d,e){var k,l;k=a[0];a=a[1];switch(k){case ".":h(a);
c(e,d);break;case "r":h("\n");c(e,d);break;case "i":c(e,d);break;case "k":c(e,["k1",d]);break;case "k1":c(e,a);break;case "s":c(e,["s1",d]);break;case "s1":c(e,["s2",[a,d]]);break;case "s2":k=a[0];l=a[1];j(k,d,function(a){return j(l,d,function(c){return j(a,c,e)})});break;case "v":c(e,["v",null]);break;case "d1":g(["`",[a,d]],function(a){return c(e,a)});break;case "e":b(d);break;case "@":f(function(a){i=a!=null?a[0]:void 0;return g(["`",[d,[i!=null?"i":"v",null]]],e)});break;case "|":i!=null?g(["`",
[d,[".",i]]],e):g(["`",[d,["v",null]]],e);break;case "?":a=i===a?"i":"v";g(["`",[d,[a,null]]],e);break;case "c":g(["`",[d,["c1",e]]],e);break;case "c1":c(a,d);break;default:m(Error("Unknown function: "+k))}return null};g=function(a,d){var e,b,f;f=a[0];b=a[1];f==="`"?(f=b[0],e=b[1],g(f,function(a){return a[0]==="d"?c(d,["d1",e]):g(e,function(b){return j(a,b,function(a){return c(d,a)})})})):c(d,[f,b]);return null};g(a,function(a){return b(a)});return null}}}).call(this);
